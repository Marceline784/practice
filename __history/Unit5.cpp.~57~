//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "Unit5.h"
#include "Unit3.h"
#include "Unit2.h"
#include "Unit1.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma link "HTMLabel"
#pragma link "AdvEdit"
#pragma link "DBAdvEd"
#pragma link "AdvGlowButton"
#pragma resource "*.dfm"
TForm5 *Form5;
//---------------------------------------------------------------------------
__fastcall TForm5::TForm5(TComponent* Owner)
	: TForm(Owner)
{
Form5->Color = (TColor)0x1E1E1E;
Image1->Picture->LoadFromFile("D:\\Документи\\Практика\\useer.png");
Image2->Picture->LoadFromFile("D:\\Документи\\Практика\\arrow.png");
	Edit1->Color = (TColor)0x1E1E1E;


Edit2->Color = (TColor)0x1E1E1E;
 	LoadUserData();
}

 void __fastcall TForm5::LoadUserData()
{
if (CurrentUserId <= 0) return;

	try {
		Form1->ADOQuery1->Close();
		Form1->ADOQuery1->SQL->Text = "SELECT ПІБ, Телефон FROM Користувачі WHERE Користувач = :id";
		Form1->ADOQuery1->Parameters->ParamByName("id")->Value = CurrentUserId;
		Form1->ADOQuery1->Open();

		if (!Form1->ADOQuery1->IsEmpty()) {
			Edit1->Text = Form1->ADOQuery1->FieldByName("ПІБ")->AsString;
			Edit2->Text = Form1->ADOQuery1->FieldByName("Телефон")->AsString;
		}
	}
	catch (const Exception &e) {
		ShowMessage("Помилка завантаження профілю: " + e.Message);
	}
}


void __fastcall TForm5::Image2Click(TObject *Sender)
{
Form3->Show();
	this->Hide();
}


//---------------------------------------------------------------------------


